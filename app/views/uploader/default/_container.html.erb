<%= content_tag(:div, :id => field.id, :class => "uploader-dnd-area") do -%>
  <%= hidden_field(field.object_name, :fileupload_guid) if field.object.new_record? %>
  
	<div class="uploader-dnd-hints">
	  <%= fields_for field.object do |f| -%>
	    <%= f.fields_for field.method_name, field.value do |m| -%>
        <%= m.file_field(:data, field.input_html) %>
	    <% end -%>
	  <% end -%>
	  
		<input type="button" class="uploader-button gray" value="Выберите файл на компьютере">
		или<span>Перетащите фотографию сюда</span>
	</div>
	
	<%= render :partial => "uploader/#{field.theme}/init" %>
	
	<script type="text/javascript">
    $(function() {
      $('#<%= field.id %> input[type="file"]').bind("init.uploader", function(e){
        $(this).fileupload({
          dataType: 'json',
          dropZone: $("#<%= field.id %>"),
          autoUpload: true,
          paramName: "asset[data]",
          formData: function(form){ return []; }
        });
      });
    });
  </script>
<% end -%>

<%= render :partial => "uploader/#{field.theme}/upload" %>
<%= render :partial => "uploader/#{field.theme}/download" %>
